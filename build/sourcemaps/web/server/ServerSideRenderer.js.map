{"version":3,"sources":["web/server/ServerSideRenderer.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;QAAO,gBAAgB;;qBAEL,OAAO;;;;2BACN,cAAc;;;;oBAEhB,QAAQ;;;;6BAEN,mBAAmB;;;;IAEjB,kBAAkB;AAC1B,WADQ,kBAAkB,CACzB,eAAe,EAAE;0BADV,kBAAkB;;AAEnC,QAAI,CAAC,eAAe,GAAG,eAAe,CAAC;GACxC;;eAHkB,kBAAkB;;6BAKhB,WAAC,GAAG,EAAE;;;;qBAGJ,OAAO,CAAC,cAAc,CAAC;;UAAtC,UAAU,YAAV,UAAU;;AAChB,YAAM,CAAC,uBAAuB,GAAG,UAAU,CAAC;;AAE5C,UAAI,UAAU,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC;AACjD,UAAI,MAAM,GAAG,mBAAM,oBAAoB,CACrC;AACE,uBAAe,EAAE,IAAI,CAAC,eAAe,AAAC;AACtC,cAAM,EAAE,EAAE,MAAM,EAAE,UAAU,EAAE,AAAC;QAC/B,CACH,CAAC;AACF,aAAO,kBAAK,OAAO,GAAG,MAAM,CAAC;KAC9B;;;WAEc,yBAAC,GAAG,EAAE;AACnB,aAAO,aAAY,UAAC,OAAO,EAAE,MAAM,EAAK;AACtC,iCAAO,GAAG,6BAAS,GAAG,EAAE,UAAA,IAAI,EAAI;;AAE9B,cAAI,MAAM,GAAG,mBAAM,cAAc,CAAC,iCAAC,IAAI,OAAG,CAAC,CAAC;AAC5C,iBAAO,CAAC,MAAM,CAAC,CAAC;SACjB,CAAC,CAAC;OACJ,CAAC,CAAC;KACJ;;;SA7BkB,kBAAkB;;;qBAAlB,kBAAkB","file":"web/server/ServerSideRenderer.js","sourcesContent":["import 'babel/polyfill';\n\nimport React from 'react';\nimport Router from 'react-router';\n\nimport Page from './Page';\n\nimport routes from '../browser/routes';\n\nexport default class ServerSideRenderer {\n  constructor(staticResources) {\n    this.staticResources = staticResources;\n  }\n\n  async renderPageAsync(url) {\n    // Define __webpack_public_path__ which is used by the JS modules that\n    // substitute in for asset files like images\n    let { publicPath } = require('./stats.json');\n    global.__webpack_public_path__ = publicPath;\n\n    let bodyMarkup = await this.renderBodyAsync(url);\n    let markup = React.renderToStaticMarkup(\n      <Page\n        staticResources={this.staticResources}\n        markup={{ __html: bodyMarkup }}\n      />\n    );\n    return Page.doctype + markup;\n  }\n\n  renderBodyAsync(url) {\n    return new Promise((resolve, reject) => {\n      Router.run(routes, url, Root => {\n        // TODO: Perform data fetching here and pass it in as props of the root\n        let markup = React.renderToString(<Root />);\n        resolve(markup);\n      });\n    });\n  }\n}\n"],"sourceRoot":"/source/"}